<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" name="viewport">
    <title>个人中心</title>

    <!-- 引入样式 -->

    <link rel="stylesheet" href="../plugins/elementui/index.css">

    <link rel="stylesheet" href="../plugins/font-awesome/css/font-awesome.min.css">

    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<div id="app">
    <div>
        <el-container>
            <el-header>
                <div id="header">
                    <div id="h_left">
                        <img src="../img/Microsoft.png">
                    </div>
                </div>
            </el-header>
            <header>


                    <el-menu
                            :default-active="activeIndex2"
                            class="el-menu-demo"
                            mode="horizontal"
                            @select="handleSelect"
                            background-color="#545c64"
                            text-color="#fff"
                            active-text-color="#ffd04b">
                        <el-menu-item index="1">
                                <div>
                                    <img src="../img/Microsoft2.png" @click="mainPage" title="首页">
                                </div>
                        </el-menu-item>

                    </el-menu>

            </header>
            <el-main>
                <div>
                    <div id="form">
                        <el-form :model="userData" :rules="rules" ref="userForm" label-width="100px">
                            <el-form-item label="用户名" prop="user_name">
                                <el-input v-model="userData.user_name" placeholder="请输入用户名"></el-input>
                            </el-form-item>
                            <el-form-item label="密码" prop="password">
                                <el-input v-model="userData.password" placeholder="请输入密码"></el-input>
                            </el-form-item>
                            <el-form-item label="姓名" prop="name">
                                <el-input v-model="userData.name" placeholder="请输入姓名"></el-input>
                            </el-form-item>
                            <el-form-item label="性别" prop="user_gender">
                                <el-radio-group v-model="userData.user_gender">
                                    <el-radio label="男"></el-radio>
                                    <el-radio label="女"></el-radio>
                                </el-radio-group>
                            </el-form-item>
                            <el-form-item label="手机号码" prop="user_phone">
                                <el-input v-model="userData.user_phone" placeholder="请输入手机号码"></el-input>
                            </el-form-item>
                            <el-form-item label="QQ" prop="user_qq">
                                <el-input v-model="userData.user_qq" placeholder="请输入QQ"></el-input>
                            </el-form-item>
                            <el-form-item label="Email" prop="user_email">
                                <el-input v-model="userData.user_email" placeholder="请输入邮箱"></el-input>
                            </el-form-item>
                            <el-form-item label="地址" prop="user_address">
                                <el-select v-model="userData.user_address" placeholder="请选择地址">
                                    <el-option label="北京市" value="北京市"></el-option>
                                    <el-option label="天津市" value="天津市"></el-option>
                                    <el-option label="河北省" value="河北省"></el-option>
                                    <el-option label="山西省" value="山西省"></el-option>
                                    <el-option label="辽宁省" value="辽宁省"></el-option>
                                    <el-option label="吉林省" value="吉林省"></el-option>
                                    <el-option label="黑龙江省" value="黑龙江省"></el-option>
                                    <el-option label="江苏省" value="江苏省"></el-option>
                                    <el-option label="浙江省" value="浙江省"></el-option>
                                    <el-option label="安徽省" value="安徽省"></el-option>
                                    <el-option label="福建省" value="福建省"></el-option>
                                    <el-option label="江西省" value="江西省"></el-option>
                                    <el-option label="山东省" value="山东省"></el-option>
                                    <el-option label="河南省" value="河南省"></el-option>
                                    <el-option label="湖北省" value="湖北省"></el-option>
                                    <el-option label="湖南省" value="湖南省"></el-option>
                                    <el-option label="广东省" value="广东省"></el-option>
                                    <el-option label="海南省" value="海南省"></el-option>
                                    <el-option label="四川省" value="四川省"></el-option>
                                    <el-option label="贵州省" value="贵州省"></el-option>
                                    <el-option label="云南省" value="云南省"></el-option>
                                    <el-option label="陕西省" value="陕西省"></el-option>
                                    <el-option label="甘肃省" value="甘肃省"></el-option>
                                    <el-option label="青海省" value="青海省"></el-option>
                                    <el-option label="台湾省" value="台湾省"></el-option>
                                    <el-option label="内蒙古自治区" value="内蒙古自治区"></el-option>
                                    <el-option label="广西壮族自治区" value="广西壮族自治区"></el-option>
                                    <el-option label="西藏自治区" value="西藏自治区"></el-option>
                                    <el-option label="宁夏回族自治区" value="宁夏回族自治区"></el-option>
                                    <el-option label="新疆维吾尔自治区" value="新疆维吾尔自治区"></el-option>
                                    <el-option label="香港特别行政区" value="香港特别行政区"></el-option>
                                    <el-option label="澳门特别行政区" value="澳门特别行政区"></el-option>
                                </el-select>
                            </el-form-item>
                            <el-form-item>
                                <el-button type="primary" @click="handleEdit">确定</el-button>
                                <el-button @click="reset">重置</el-button>
                            </el-form-item>
                        </el-form>
                    </div>
                </div>

            </el-main>
        </el-container>
    </div>
</div>

</body>

<!-- 引入组件库 -->

<script src="../js/vue.js"></script>

<script src="../plugins/elementui/index.js"></script>

<script type="text/javascript" src="../js/jquery.min.js"></script>

<script src="../js/axios-0.18.0.js"></script>

<script>
    var app = new Vue({
        el:'#app',
        data:{
            userData:{},
            username:window.sessionStorage.getItem("username"),
            rules:{
                user_name:[
                    {required:true,message:'请输入用户名',trigger:'blur'},
                    {message: "用户名只能包含数字和字母,且长度在3-15字符",trigger: 'blur',pattern:/^[a-z0-9]{3,15}$/},
                ],
                password:[
                    {required:true,message:'请输入密码',trigger:'blur'},
                    {message: "密码只能包含数字和字母,且长度在6-15字符",trigger: 'blur',pattern:/^[a-z0-9]{6,15}$/},
                ],
                name:[

                ],
                user_phone:[
                    {message:'请输入正确的手机号',trigger:'blur',pattern:/^1[3456789]\d{9}$/}
                ],
                user_qq:[
                    {message:'请输入正确的QQ号',trigger:'blur',pattern:/^[123456789]\d{4,11}$/}
                ],
                user_email:[
                    {message:'请输入正确的邮箱',trigger:'blur',pattern:/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/}
                ]
            }
        },

        created(){
            this.getUser();
        },

        methods:{
            getUser(){
                axios.get("/users/userEdit/" + window.sessionStorage.getItem("username")).then((res)=>{
                    this.userData = res.data.data;
                })
            },

            mainPage(){
                window.location.href="../pages/main.html"
            },

            reset(){
                this.userData={};
            },

            handleEdit(){
                axios.put("/users",this.userData).then((res)=>{
                    if (res.data.code == 20031) {
                        this.$message.success("修改成功");
                    } else if (res.data.code == 20030) {
                        this.$message.error("修改失败");
                    } else {
                        this.$message.error(res.data.msg);
                    }
                })
            }

        }
    })
</script>

<style>
    #header{
        padding: 10px;
    }

    #h_left{
        float: left;
    }

    #form{
        width: 600px;
        height: 750px;
        margin: auto;
    }

</style>
</html>